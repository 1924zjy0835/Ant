function FrontBase(){}function Auth(){this.siginBtn=$(".signin-btn"),this.signupBtn=$(".signup-btn"),this.closeBtn=$(".closeBtn"),this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper"),this.signinGroup=$(".signin-group"),this.signupGroup=$(".signup-group")}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.run=function(){this.listenShowHideEvent(),this.listenCloseBtn(),this.listenSignInEvent(),this.listenImgCaptchaEvent(),this.listenSmsCaptchaEvent(),this.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this;t.siginBtn.click(function(){t.showEvent(),t.scrollWrapper.css({left:"0"})}),t.signupBtn.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),t.closeBtn.click(function(){t.hideEvent()})},Auth.prototype.listenCloseBtn=function(){var t=$(".switch"),n=this;t.click(function(){var t=n.scrollWrapper.css("left");parseInt(t)<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSignInEvent=function(){var s=this,i=s.signinGroup.find("input[name='telephone']"),o=s.signinGroup.find("input[name='password']"),a=s.signinGroup.find("input[name='remember']");s.signinGroup.find(".submit-btn").click(function(){var t=i.val(),n=o.val(),e=a.prop("checked");antajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){200===t.code&&(s.hideEvent(),window.location.reload())}})})},Auth.prototype.listenSignupEvent=function(){var h=this;h.signupGroup.find(".submit-btn").click(function(){var t=h.signupGroup.find("input[name='telephone']"),n=h.signupGroup.find("input[name='username']"),e=h.signupGroup.find("input[name='password']"),s=h.signupGroup.find("input[name='repeat_password']"),i=h.signupGroup.find("input[name='img_captcha']"),o=h.signupGroup.find("input[name='sms_captcha']"),a=t.val(),r=n.val(),p=e.val(),u=s.val(),c=i.val(),l=o.val();antajax.post({url:"/account/register/",data:{telephone:a,username:r,password:p,repeat_password:u,img_captcha:c,sms_captcha:l},success:function(t){200===t.code?window.location.reload():window.close()}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img_captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this,n=$(".sms-captcha-btn");messageBox.showSuccess("短信验证码发送成功！"),n.addClass("disabled");var e=10;n.unbind("click");var s=setInterval(function(){n.text("重新发送"+e+"s"),--e<=0&&(clearInterval(s),n.removeClass("disabled"),n.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码！"),antajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200===t.code&&(n.smsSuccessEvent(),console.log(t))},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){template&&(template.defaults.imports.dateFormat=function(t){var n=new Date(t).getTime(),e=((new Date).getTime()-n)/1e3;if(e<60)return"刚刚";if(60<=e&&e<3600)return(p=parseInt(e/60))+"分钟前";if(3600<=e&&e<86400)return hours=parseInt(e/60/60),hours+"小时前";if(86400<=e&&e<2592e3)return days=parseInt(e/60/60/24),days+"天前";var s=new Date(t),i=s.getFullYear(),o=s.getMonth(),a=s.getDay(),r=s.getHours(),p=s.getMinutes();return i+"/"+o+"/"+a+" "+r+":"+p})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZyb250QmFzZUhlYWRlci5qcyJdLCJuYW1lcyI6WyJGcm9udEJhc2UiLCJBdXRoIiwidGhpcyIsInNpZ2luQnRuIiwiJCIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwibWFza1dyYXBwZXIiLCJzY3JvbGxXcmFwcGVyIiwic2lnbmluR3JvdXAiLCJzaWdudXBHcm91cCIsInByb3RvdHlwZSIsInJ1biIsImxpc3RlbkF1dGhCb3hIb3ZlciIsImF1dGhCb3giLCJ1c2VyTW9yZUJveCIsImhvdmVyIiwic2hvdyIsImhpZGUiLCJsaXN0ZW5TaG93SGlkZUV2ZW50IiwibGlzdGVuQ2xvc2VCdG4iLCJsaXN0ZW5TaWduSW5FdmVudCIsImxpc3RlbkltZ0NhcHRjaGFFdmVudCIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsImxpc3RlblNpZ251cEV2ZW50Iiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50Iiwic2VsZiIsImNsaWNrIiwiY3NzIiwibGVmdCIsInN3aXRjaGVyIiwid3JhcHBlckxlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwiYW50YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIiwidXNlcm5hbWVJbnB1dCIsInJlcGVhdF9wYXNzd29yZElucHV0IiwiaW1nX2NhcHRjaGFJbnB1dCIsInNtc19jYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsInJlcGVhdF9wYXNzd29yZCIsImltZ19jYXB0Y2hhIiwic21zX2NhcHRjaGEiLCJjbG9zZSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwic21zU3VjY2Vzc0V2ZW50Iiwic21zQ2FwdGNoYSIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsInNob3dJbmZvIiwiZ2V0IiwiY29uc29sZSIsImxvZyIsImZhaWwiLCJlcnJvciIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwiZGF0ZUZvcm1hdCIsImRhdGVWYWx1ZSIsImRhdGVTdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwidGltZVN0YW1wIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsImRhdGUiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJtb250aCIsImdldE1vbnRoIiwiZGF5IiwiZ2V0RGF5IiwiaG91ciIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBVUEsU0FBU0EsYUFtQ1QsU0FBU0MsT0FDTEMsS0FBS0MsU0FBV0MsRUFBRSxlQUNsQkYsS0FBS0csVUFBWUQsRUFBRSxlQUNuQkYsS0FBS0ksU0FBV0YsRUFBRSxhQUNsQkYsS0FBS0ssWUFBY0gsRUFBRSxpQkFDckJGLEtBQUtNLGNBQWdCSixFQUFFLG1CQUN2QkYsS0FBS08sWUFBY0wsRUFBRSxpQkFDckJGLEtBQUtRLFlBQWNOLEVBQUUsaUJBcEN6QkosVUFBVVcsVUFBVUMsSUFBTSxXQUNYVixLQUNOVyxzQkFHVGIsVUFBVVcsVUFBVUUsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVWLEVBQUUsYUFDWlcsRUFBY1gsRUFBRSxrQkFFcEJVLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQTJCcEJqQixLQUFLVSxVQUFVQyxJQUFNLFdBQ2pCVixLQUFLaUIsc0JBQ0xqQixLQUFLa0IsaUJBQ0xsQixLQUFLbUIsb0JBQ0xuQixLQUFLb0Isd0JBQ0xwQixLQUFLcUIsd0JBQ0xyQixLQUFLc0IscUJBSVR2QixLQUFLVSxVQUFVYyxVQUFZLFdBQ1p2QixLQUNOSyxZQUFZVSxRQUlyQmhCLEtBQUtVLFVBQVVlLFVBQVksV0FDWnhCLEtBQ05LLFlB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QVVHLEVBQUtTLGFBRW5CLE9BQU9SLEVBQU8sSUFBTUUsRUFBUSxJQUFNRSxFQUFNLElBQU1FLEVBQU8sSUFBTVYiLCJmaWxlIjoiRnJvbnRCYXNlSGVhZGVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBEZXNjcmlwdGlvbjogRnJvbnRCYXNlSGVhZGVyLmpzXHJcbiAqIEBBdXRob3I6IOWtpOeDn+mAkOS6kXpqeVxyXG4gKiBARGF0ZTogMjAyMC8zLzI1IDEyOjI2XHJcbiAqIEBTb2Z0V2FyZTogUHlDaGFybVxyXG4gKiBAQ1NETjogaHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3pqeTEyMzA3OF96anlcclxuICogQOWNmuWuouWbrTogaHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZ3V5YW4tMjAyMC9cclxuICovXHJcblxyXG4vLyDlrprkuYnmnoTpgKDlh73mlbBGcm9udEJhc2VIZWFkZXJcclxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xyXG5cclxufVxyXG5cclxuXHJcbi8vIOivpeexu+WvueixoeeahOWFpeWPo1xyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJChcIi5hdXRoLWJveFwiKTtcclxuICAgIHZhciB1c2VyTW9yZUJveCA9ICQoXCIudXNlci1tb3JlLWJveFwiKTtcclxuXHJcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5zaG93KCk7XHJcbiAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuLy8g5a6a5LmJ5LiA5Liq55uR5ZCs5oyJ6ZKu55m75b2V5ZKM5rOo5YaM5Yqf6IO95ZKM5YWz6Zet5oyJ6ZKu55qE5LqL5Lu2XHJcbi8vICQoZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgJChcIiNidG5cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgICQoXCIubWFzay13cmFwcGVyXCIpLnNob3coKTtcclxuLy8gICAgIH0pO1xyXG4vLyAgICAgJChcIi5jbG9zZS1idG5cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgICQoXCIubWFzay13cmFwcGVyXCIpLmhpZGUoKTtcclxuLy8gICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG4vLyDlrprkuYnmnoTpgKDlh73mlbBBdXRoXHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB0aGlzLnNpZ2luQnRuID0gJChcIi5zaWduaW4tYnRuXCIpO1xyXG4gICAgdGhpcy5zaWdudXBCdG4gPSAkKFwiLnNpZ251cC1idG5cIik7XHJcbiAgICB0aGlzLmNsb3NlQnRuID0gJChcIi5jbG9zZUJ0blwiKTtcclxuICAgIHRoaXMubWFza1dyYXBwZXIgPSAkKFwiLm1hc2std3JhcHBlclwiKTtcclxuICAgIHRoaXMuc2Nyb2xsV3JhcHBlciA9ICQoXCIuc2Nyb2xsLXdyYXBwZXJcIik7XHJcbiAgICB0aGlzLnNpZ25pbkdyb3VwID0gJChcIi5zaWduaW4tZ3JvdXBcIik7XHJcbiAgICB0aGlzLnNpZ251cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpO1xyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuQ2xvc2VCdG4oKTtcclxuICAgIHRoaXMubGlzdGVuU2lnbkluRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgdGhpcy5saXN0ZW5TaWdudXBFdmVudCgpO1xyXG59O1xyXG5cclxuLy8g5a6a5LmJ55uR5ZCs54K55Ye75pi+56S65LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5cclxuLy8g5a6a5LmJ55uR5ZCs6ZqQ6JeP5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuaGlkZSgpO1xyXG59O1xyXG5cclxuLy8g5a6a5LmJ54K55Ye75LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnNpZ2luQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiBcIjBcIn0pO1xyXG4gICAgfSk7XHJcbiAgICBzZWxmLnNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogXCItNDAwcHhcIn0pO1xyXG4gICAgfSk7XHJcbiAgICBzZWxmLmNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuLy8g5a6a5LmJ55uR5ZCs55m75b2V5ZKM5rOo5YaM6aG16Z2i5LmL6Ze055qE6Lez6L2s5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkNsb3NlQnRuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHN3aXRjaGVyID0gJChcIi5zd2l0Y2hcIik7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzd2l0Y2hlci5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHdyYXBwZXJMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbiAgICAgICAgLy8g5LiA5a6a6KaB5bCG6I635Y+W5Yiw55qEd3JhcHBlckxlZnTnmoTlgLzvvIjlg4/ntKDlgLzvvInovazmjaLkuLrmlbTmlbDvvIzlkKbogIXnmoTor53vvIzkuI3og73ov5vooYzkuI4w5q+U6L6DXHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQod3JhcHBlckxlZnQpO1xyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiBcIjBcIn0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjogXCItNDAwcHhcIn0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8g55uR5ZCs5o+Q5Lqk5LiK5p2l55qE55m75b2V5pWw5o2uXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25JbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2VsZi5zaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNlbGYuc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkJ11cIik7XHJcblxyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzZWxmLnNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdyZW1lbWJlciddXCIpO1xyXG5cclxuICAgIHZhciBzdWJtaXRCdG4gPSBzZWxmLnNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgYW50YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgIC8vIOS9v+eUqOS4ieebrui/kOeul+esplxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXIgPyAxIDogMCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDph43mlrDliLfmlrB3aW5kb3dz6aG16Z2iXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOeZu+W9leaIkOWKn++8jOWwsemakOiXj21hc2t3cmFwcGVyXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgICAgIHZhciByZXBlYXRfcGFzc3dvcmRJbnB1dCA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlcGVhdF9wYXNzd29yZCddXCIpO1xyXG4gICAgICAgIHZhciBpbWdfY2FwdGNoYUlucHV0ID0gc2VsZi5zaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGFJbnB1dCA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Ntc19jYXB0Y2hhJ11cIik7XHJcblxyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlcGVhdF9wYXNzd29yZCA9IHJlcGVhdF9wYXNzd29yZElucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBpbWdfY2FwdGNoYSA9IGltZ19jYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zX2NhcHRjaGFJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgYW50YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlcGVhdF9wYXNzd29yZCc6IHJlcGVhdF9wYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdpbWdfY2FwdGNoYSc6IGltZ19jYXB0Y2hhLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGEsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAg5YWz6ZetZm9ybeihqOWNlem7mOiupOeahOaPkOS6pOS6i+S7tlxyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIOebkeWQrOeCueWHu+mqjOivgeeggeWIh+aNouS6i+S7tlxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgaW1nX2NhcHRjaGEgPSAkKFwiLmltZ19jYXB0Y2hhXCIpO1xyXG5cclxuICAgIGltZ19jYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWdfY2FwdGNoYS5hdHRyKFwic3JjXCIsIFwiL2FjY291bnQvaW1nX2NhcHRjaGEvXCIgKyBcIj9yYW5kb209XCIgKyBNYXRoLnJhbmRvbSgpKVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc21zQ2FwdGNoYSA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcclxuICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oemqjOivgeeggeWPkemAgeaIkOWKn++8gScpO1xyXG4gICAgc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIHZhciBjb3VudCA9IDEwO1xyXG4gICAgLy8g5riF6Zmk54K55Ye75LqL5Lu277yM5q2k5pe25bCx5LiN6IO95YaN5Y+R6YCB6aqM6K+B56CB5LqGXHJcbiAgICBzbXNDYXB0Y2hhLnVuYmluZCgnY2xpY2snKTtcclxuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzbXNDYXB0Y2hhLnRleHQoXCLph43mlrDlj5HpgIFcIiArIGNvdW50ICsgJ3MnKTtcclxuICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgIGlmIChjb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICBzbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICBzbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDApO1xyXG59O1xyXG5cclxuLy8g55uR5ZCs6aqM6K+B56CB54K55Ye75LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzbXNDYXB0Y2hhID0gJCgnLnNtcy1jYXB0Y2hhLWJ0bicpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gJChcIi5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICAvLyB2YXIgdGVsZXBob25lSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuXHJcbiAgICBzbXNDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgaWYgKCF0ZWxlcGhvbmUpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6K+36L6T5YWl5omL5py65Y+356CB77yBJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFudGFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGZyb250QmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcclxuICAgIGZyb250QmFzZS5ydW4oKTtcclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIOmmluWFiOmcgOimgeWIpOaWreaYr+WQpuWKoOi9veS6hui/meS4qnRlbXBsYXRl5paH5Lu277yM5Y+q5pyJ5Yqg6L295LqG77yM5omN5Lya5omn6KGM5Lul5LiL5Luj56CBXHJcbiAgICBpZiAodGVtcGxhdGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLmRhdGVGb3JtYXQgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlU3RhbXAgPSAobmV3IERhdGUoZGF0ZVZhbHVlKSkuZ2V0VGltZSgpOyAvLyDlvpfliLDnmoTmmK/lvZPliY3nmoTml7bpl7TvvIzmr6vnp5JcclxuICAgICAgICAgICAgdmFyIGRhdGVTdGFtcE5vdyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7IC8vIOiOt+WPluW9k+WJjeeahOaXtumXtO+8jOavq+enklxyXG4gICAgICAgICAgICB2YXIgdGltZVN0YW1wID0gKGRhdGVTdGFtcE5vdyAtIGRhdGVTdGFtcCkgLyAxMDAwOyAvLyDojrflj5bml7bpl7TmiLNcclxuICAgICAgICAgICAgaWYgKHRpbWVTdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCLliJrliJpcIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lU3RhbXAgPj0gNjAgJiYgdGltZVN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVTdGFtcCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzICsgXCLliIbpkp/liY1cIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lU3RhbXAgPj0gNjAgKiA2MCAmJiB0aW1lU3RhbXAgPCA2MCAqIDYwICogMjQpIHtcclxuICAgICAgICAgICAgICAgIGhvdXJzID0gcGFyc2VJbnQodGltZVN0YW1wIC8gNjAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91cnMgKyBcIuWwj+aXtuWJjVwiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRpbWVTdGFtcCA+PSA2MCAqIDYwICogMjQgJiYgdGltZVN0YW1wIDwgNjAgKiA2MCAqIDI0ICogMzApIHtcclxuICAgICAgICAgICAgICAgIGRheXMgPSBwYXJzZUludCh0aW1lU3RhbXAgLyA2MCAvIDYwIC8gMjQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyBcIuWkqeWJjVwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8ganPmlofku7bkuK3kuI3og73kvb/nlKjov5nnp43lvaLlvI/ov5Tlm57lrZfnrKbkuLJcclxuICAgICAgICAgICAgICAgIC8vIHJldHVybiBkYXRlVmFsdWUuc3RyZnRpbWUoXCIlWS8lbS8lZCAlSDolTVwiKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGVzID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHllYXIgKyAnLycgKyBtb250aCArICcvJyArIGRheSArICcgJyArIGhvdXIgKyAnOicgKyBtaW51dGVzO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7Il19
